<!DOCTYPE html>
<html>
  <head>
    <title>Matematikai Kocka - Referencia</title>
    <meta charset="utf-8">
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
        
    <style>
      .vezerlo-gomb {
        position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
        padding: 15px 30px; font-size: 18px; background-color: #4CAF50; color: white;
        border: none; border-radius: 8px; cursor: pointer; z-index: 9999;
        box-shadow: 0 4px 6px rgba(0,0,0,0.3); font-family: sans-serif;
        font-weight: bold;
      }
      .vezerlo-gomb:hover { background-color: #45a049; }
    </style>

    <script>
      AFRAME.registerComponent('haromszog-rajzolo', {
        schema: {
          A: {type: 'vec3', default: {x: 0, y: 0, z: 0}},
          B: {type: 'vec3', default: {x: 0, y: 1, z: 0}},
          C: {type: 'vec3', default: {x: 1, y: 0, z: 0}},
          szin: {type: 'color', default: 'yellow'}
        },
        init: function () {
          var data = this.data;
          var geometry = new THREE.BufferGeometry();
          
          // Csúcsok definiálása
          var vertices = new Float32Array([
            data.A.x, data.A.y, data.A.z,
            data.B.x, data.B.y, data.B.z,
            data.C.x, data.C.y, data.C.z
          ]);

          geometry.setAttribute('position', new THREE.BufferAttribute(vertices, 3));
          geometry.computeVertexNormals(); 

          // Anyag beállítása (kétoldalas, hogy minden irányból látsszon)
          var material = new THREE.MeshBasicMaterial({
            color: data.szin, 
            side: THREE.DoubleSide, 
            opacity: 0.9,
            transparent: true,
            depthTest: false // RÖNTGEN MÓD: Mindig látszik, akkor is, ha a kocka takarná
          });

          var mesh = new THREE.Mesh(geometry, material);
          this.el.setObject3D('mesh', mesh);
        }
      });
    </script>
  </head>
  <body>
    
    <button class="vezerlo-gomb" onclick="metszetKapcsolas()">
      Metszet Be/Ki
    </button>

    <a-scene renderer="sortObjects: true; antialias: true">
      
      <a-plane position="0 0 0" rotation="-90 0 0" width="20" height="20" color="#8B5A2B"></a-plane>
      <a-entity light="type: ambient; color: #FFF; intensity: 0.6"></a-entity>
      <a-entity light="type: directional; intensity: 0.8" position="-1 1 1"></a-entity>

      <a-entity position="0 1.6 0" animation="property: rotation; to: 0 360 0; loop: true; dur: 25000; easing: linear">
        
        <a-box id="kocka"
               position="0 0 0"
               width="2" height="2" depth="2"
               material="color: #00ff00; opacity: 0.15; transparent: true; side: double; depthWrite: false">
               
               <a-entity geometry="primitive: box; width: 2; height: 2; depth: 2"
                         material="wireframe: true; color: white; opacity: 0.5">
               </a-entity>
        </a-box>

        <a-entity id="metszet"
                  visible="false"
                  haromszog-rajzolo="A: -1 -1 -1; B: 1 1 -1; C: 1 1 1; szin: #FFD700">
        </a-entity>

        <a-sphere position="-1 -1 -1" radius="0.05" color="red"></a-sphere>   <a-sphere position="1 1 -1" radius="0.05" color="blue"></a-sphere>  <a-sphere position="1 1 1" radius="0.05" color="green"></a-sphere>  </a-entity>

      <a-entity id="rig" position="0 1.6 4">
        <a-entity camera look-controls wasd-controls></a-entity>
      </a-entity>

    </a-scene>

    <script>
      function metszetKapcsolas() {
        var metszetElem = document.querySelector('#metszet');
        var jelenlegi = metszetElem.getAttribute('visible');
        metszetElem.setAttribute('visible', !jelenlegi);
      }
    </script>
  </body>
</html>
